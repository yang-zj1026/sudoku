# 简介

本文件夹包含了2020-2021学年 EI339 个人编程大作业的代码，可以对图片中的数独进行识别并求解. 

作者：杨朝竞 518030910288

下面简要介绍如何使用文件夹中的主要内容.

## solve_sudoku.py

数独求解程序.

参数：

`show_details` : 若为 `False` 只展示结果，`True`展示求解的关键步骤.

`debug` : 若为 `True` 展示数独求解的详细步骤.

从指定的路径获取图片，截取出其中的数独；再从指定的路径加载训练好的模型（.h5格式）对数独中的数字进行识别，并对数独进行求解.

文件中的 `model_path` 为模型的路径，`image_path` 为图片的路径.

预设定的模型 `my_net_98.h5` 在 `test1` 测试集上识别正确率为100%.

## Utilities.py

包含数独求解过程中需要使用的数独识别、数字提取功能.

## models.py

模型类，包含`LeNet` 和自定义的 `MyNet` . 

## train_model.py

在 MNIST 和 EI339-CN SJTU 数据集上进行模型训练，并将训练完成的模型保存至 `model` 目录下.

若想更改模型的相关参数，可针对性地修改 `BS` , `lr` ,  `EPOCH`.

## test_model.py

利用 `test1` 中的图片对 `model` 目录下存储的所有模型进行测试.

## my_sudoku.py

数独类，可用于数独求解、数独修正.

## solve_dlx.py

运用 DLX 对数独进行求解，在求解较为困难的数独时表现优秀.

## opencv-sudoku-solver

一个数独识别的范例项目，只可识别阿拉伯数字.

## EI339-CN dataset SJTU

手写中文数字数据集，其中的某些图片不合规范，需手动剔除.

## Data

存储用于训练的数据集，其中的文件为 `.npy` 格式.

## model

包含所有训练好的模型.

## test1

包含用于测试的图片.

## train_log

保存了训练过程的数据.

